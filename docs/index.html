<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brisbane PTAL Explorer - Public Transport Accessibility</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Brisbane PTAL Explorer</h1>
        <p>Mapping public transport accessibility in inner Brisbane ¬∑ Click on any grid cell for details</p>
    </header>

    <!-- Address Search -->
    <div id="address-search">
        <input type="text" id="address-input" placeholder="Search address (e.g. 1 Queen St, Brisbane)">
        <button id="search-btn">Search</button>
    </div>

    <div id="map"></div>
    
    <div id="legend">
    <div id="legend-toggle">Legend ‚¨á</div>
    <div class="legend-content">
        <h3>PTAL Score</h3>
        <div><span class="legend-color ptal-4"></span> 4 - Excellent</div>
        <div><span class="legend-color ptal-3"></span> 3 - Good</div>
        <div><span class="legend-color ptal-2"></span> 2 - Moderate</div>
        <div><span class="legend-color ptal-1"></span> 1 - Poor</div>

        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #ddd;">
            <label style="display: flex; align-items: center; cursor: pointer;">
                <input type="checkbox" id="mismatch-toggle" style="margin-right: 8px;">
                <span>Show mismatches only</span>
            </label>
            <p style="margin-top: 5px; font-size: 0.85rem; color: #666;">
                Transit-rich areas restricted to low-rise
            </p>
        </div>

        <p style="margin-top: 10px; font-size: 0.85rem; color: #666;">üí° Click cells for details</p>
    </div>
</div>

   <div id="info-panel" class="hidden">
    <button id="close-panel">&times;</button>
    <h2>PTAL Score: <span id="ptal-score"></span></h2>
    <p class="category-label" id="category-label"></p>
    
    <!-- NEW: Show effective capacity -->
    <div id="capacity-info" style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin: 10px 0;">
        <strong>Effective Capacity:</strong> <span id="total-capacity"></span>
        <p style="font-size: 0.85em; color: #666; margin-top: 5px;">
            Accounts for vehicle capacity, reliability, and route overlap
        </p>
    </div>
    
    <h3>Planning Controls</h3>
    <table>
        <tr>
            <td>Zone</td>
            <td id="zone-code"></td>
        </tr>
        <tr>
            <td>Current Maximum Height</td>
            <td id="max-height"></td>
        </tr>
        <tr style="background: #e8f5e9;">
            <td><strong>Recommended Height</strong></td>
            <td><strong id="recommended-height"></strong></td>
        </tr>
    </table>
    
    <div id="mismatch-warning" class="mismatch-warning" style="display: none;">
        <p>‚ö†Ô∏è <strong>Planning Mismatch:</strong> This location has excellent transit access but is restricted to low-rise development only.</p>
    </div>
    
    <h3>Nearest Transport</h3>
    <ul id="nearby-stops"></ul>
</div>

    <footer>
        <p>Built by <a href="https://github.com/brisbane-ptal" target="_blank">PTAL Brisbane</a> | 
           Data: Brisbane City Council, TransLink</p>
        <div class="meta">
        <span id="version"></span> ¬∑ 
        <span id="ptal-thresholds"></span>
</div>
    </footer>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Pako JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    
    <!-- Custom JS -->
    <script src="map.js" defer></script>
</body>
</html>
