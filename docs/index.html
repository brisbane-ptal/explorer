<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Brisbane PTAL Explorer - Public Transport Accessibility</title>
<meta name="description" content="Explore Brisbane's public transport accessibility. See where excellent transit is restricted by outdated planning limits.">
<meta property="og:description" content="Explore Brisbane's public transport accessibility. See where excellent transit is restricted by outdated planning limits.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://brisbane-ptal.github.io/explorer/">
<meta property="og:title" content="Brisbane PTAL Explorer">
<meta property="og:image" content="https://brisbane-ptal.github.io/explorer/preview.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="Brisbane PTAL map showing public transport accessibility levels">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://brisbane-ptal.github.io/explorer/">
<meta property="twitter:title" content="Brisbane PTAL Explorer">
<meta property="twitter:description" content="Explore Brisbane's public transport accessibility. See where excellent transit is restricted by outdated height limits.">
<meta property="twitter:image" content="https://brisbane-ptal.github.io/explorer/preview.jpg"><link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<link rel="icon" id="favicon" type="image/svg+xml" href="favicon-gc.svg">
<link rel="stylesheet" href="style.css" />
<script data-goatcounter="https://brisbane-ptal.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Brisbane PTAL Explorer",
  "description": "Interactive map showing public transport accessibility levels across Brisbane",
  "url": "https://brisbane-ptal.github.io/explorer/",
  "applicationCategory": "UtilitiesApplication"
}
</script>
</head>
<body>

<header>
<h1>Brisbane PTAL Explorer</h1>
<p>Mapping public transport accessibility in inner Brisbane</p>
<div class="header-controls">
<div id="address-search">
<input type="text" id="address-input" placeholder="Search address (e.g. 1 Queen St, Brisbane)" autocomplete="street-address" />
<button id="search-btn" type="button">Search</button>
</div>
<button id="legend-burger" type="button" aria-label="Toggle legend">☰</button>
</div>
</header>

<div id="map"></div>

<div id="legend" aria-label="Legend">
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
<h3 style="margin:0;">PTAL Score</h3>
<button id="legend-toggle" type="button" aria-label="Toggle legend" style="display:none; background:none; border:none; font-size:1.2rem; cursor:pointer; color:#666;">−</button>
</div>
<div id="legend-content">
<div class="legend-row"><span class="legend-square ptal-4b"></span> 4B — Excellent</div>
<div class="legend-row"><span class="legend-square ptal-4a"></span> 4A — Very Good</div>
<div class="legend-row"><span class="legend-square ptal-3"></span> 3 — Good</div>
<div class="legend-row"><span class="legend-square ptal-2"></span> 2 — Moderate</div>
<div class="legend-row"><span class="legend-square ptal-1"></span> 1 — Poor</div>
<div class="legend-divider"></div>
<h4 style="font-size:0.95rem; margin:8px 0 8px 0; color:#555;">Overlays</h4>
<label style="display:flex; align-items:center; gap:10px; cursor:pointer; margin-bottom:8px; font-size:14px;">
  <input type="checkbox" id="mismatch-toggle" />
  Show planning mismatches
</label>
<div style="margin-left:26px; margin-bottom:12px;">
  <div style="display:flex; align-items:center; gap:8px; margin-bottom:6px;">
    <span class="legend-square" style="border:2px solid #ff0000;"></span>
    <span style="font-size:12px; color:#666;">Height Restricted</span>
  </div>
  <div style="display:flex; align-items:center; gap:8px;">
    <span class="legend-square" style="border:2px solid #9932CC;"></span>
    <span style="font-size:12px; color:#666;">Transit Gap</span>
  </div>
</div>
<label style="display:flex; align-items:center; gap:10px; cursor:pointer; margin-bottom:8px; font-size:14px;">
  <input type="checkbox" id="flood-toggle" />
  <svg width="18" height="18"><rect width="18" height="18" fill="#999"/><line x1="0" y1="18" x2="18" y2="0" stroke="rgba(0,80,150,0.8)" stroke-width="2.5"/></svg>
  Flood constraints
</label>
<label style="display:flex; align-items:center; gap:10px; cursor:pointer; margin-bottom:8px; font-size:14px;">
  <input type="checkbox" id="parking-toggle" />
  <svg width="18" height="18"><rect width="18" height="18" fill="#999"/><line x1="0" y1="0" x2="18" y2="18" stroke="rgba(220,120,0,0.8)" stroke-width="2.5"/></svg>
  Parking opportunity
</label>
<label style="display:flex; align-items:center; gap:10px; cursor:pointer; margin-bottom:8px; font-size:14px;">
  <input type="checkbox" id="greenspace-toggle" />
  <span class="legend-square" style="background:#d9ead3;"></span>
  Exclude green space
</label>
</div>
</div> <!-- CLOSE legend-content then legend -->

<div id="info-panel" class="hidden" aria-label="Info panel">
<button id="close-panel" type="button" aria-label="Close panel">&times;</button>
<h2>PTAL <span id="ptal-score"></span> <a id="grid-id-link" href="#" style="font-size:0.7em; color:#0052A5; text-decoration:none; border:1px solid #0052A5; padding:2px 6px; border-radius:4px; margin-left:8px; cursor:pointer;">...</a></h2>
<p class="category-label" id="category-label"></p>

<div style="margin-top:8px; display:flex; gap:6px; flex-wrap:wrap;">
<span id="flood-badge" style="display:none; padding:4px 10px; border-radius:6px; background:#e3f2fd; color:#0d47a1; font-size:12px; font-weight:600;">
⚠️ Flood Area
</span>
<span id="parking-badge" style="display:none; padding:4px 10px; border-radius:6px; background:#fff3cd; color:#856404; font-size:12px; font-weight:600;">
⚠️ Parking Excess
</span>
</div>

<div id="planning-mismatch-warning" class="mismatch-warning" style="display:none; background:#ffe6e6; border-left:4px solid #ff0000;">
<p>⚠️ <strong>Height Restricted:</strong> Excellent transit but height limits prevent density</p>
</div>

<div id="transit-gap-warning" class="mismatch-warning" style="display:none; background:#f3e5f5; border-left:4px solid #9932CC;">
<p>⚠️ <strong>Transit Gap:</strong> Poor transit does not serve allowed density</p>
</div>

<div id="flood-explainer" class="mismatch-warning" style="display:none; background:#e3f2fd; border-left:4px solid #0077BE;">
<p style="font-size:0.85em;">⚠️ <strong>Flood Constraints:</strong> Flood planning area suggests flooding is likely, constraining development</p>
</div>

<div id="parking-explainer" class="mismatch-warning" style="display:none; background:#fff8e1; border-left:4px solid #FFA500;">
<p style="font-size:0.85em;">⚠️ <strong>Parking Opportunity:</strong> Public transport values support a lower parking rate than zoned</p>
</div>

<div id="planning-controls">
  <h3>Planning Controls</h3>
  <table>
    <tr><td>Zone</td><td id="zone-code"></td></tr>
    <tr><td>Parking Zone</td><td id="parking-zone"></td></tr>
    <tr><td>Current Max Height</td><td id="max-height"></td></tr>
    <tr style="background:#e8f5e9;">
      <td><strong>Recommended Height</strong></td>
      <td><strong id="recommended-height"></strong></td>
    </tr>
    <tr><td>Current Parking</td><td id="current-parking"></td></tr>
    <tr style="background:#e8f5e9;">
      <td><strong>Recommended Parking</strong></td>
      <td><strong id="recommended-parking"></strong></td>
    </tr>
  </table>
</div>

<h3>Top Services <span style="font-weight:normal; font-size:0.85em; color:#666;">(by mode)</span></h3>
<ul id="nearby-stops"></ul>
</div> <!-- INFO PANEL CLOSES HERE -->

<footer>
  <p>
    <a href="https://github.com/brisbane-ptal/explorer" target="_blank" rel="noopener">About</a> |
    <a href="https://github.com/brisbane-ptal/explorer/blob/main/methodology.md" target="_blank" rel="noopener">Methodology</a> |
    <a href="#" id="email-link">Contact</a> |
    Data: Brisbane City Council, TransLink
  </p>

  <div class="meta">
    <span id="version"></span> · <span id="ptal-thresholds"></span>
  </div>

  <div class="disclaimer">
    <strong>Note:</strong> Zones, height controls, parking rates, flood planning areas are all approximate given 100m grid size. Grid cells may span multiple zones — displayed zone represents dominant zoning. Effective capacity accounts for vehicle capacity, reliability, and route overlap. Refer methodology above for further detail.
  </div>
</footer>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
<script src="map.js" defer></script>

</body>
</html>
